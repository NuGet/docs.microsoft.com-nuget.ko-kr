---
title: NuGet 플랫폼 간 플러그 인
description: NuGet .exe, dotnet, msbuild.exe 및 Visual Studio 용 NuGet 플랫폼 간 플러그 인
author: nkolev92
ms.author: nikolev
ms.date: 07/01/2018
ms.topic: conceptual
ms.openlocfilehash: 00410214500c7f5256be243dd6fca0907ba9b0c4
ms.sourcegitcommit: 363ec6843409b4714c91b75b105619a3a3184b43
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/16/2019
ms.locfileid: "72380495"
---
# <a name="nuget-cross-platform-plugins"></a>NuGet 플랫폼 간 플러그 인

NuGet 4.8 + 플랫폼 간 플러그 인에 대 한 지원이 추가 되었습니다.
이러한 작업은 엄격한 작업 규칙 집합을 준수 해야 하는 새로운 플러그 인 확장성 모델을 빌드하여에서 수행 되었습니다.
플러그 인은 자체 포함 된 실행 파일 (.NET Core 환경의 runnables) 이며, NuGet 클라이언트는 별도의 프로세스에서 시작 됩니다.
이는 한 번 쓰기 이며 모든 플러그 인을 실행 합니다. 모든 NuGet 클라이언트 도구에서 작동 합니다.
플러그 인은 .NET Framework (Nuget.exe, Msbuild.exe 및 Visual Studio) 또는 .NET Core (dotnet) 중 하나일 수 있습니다.
NuGet 클라이언트와 플러그 인 간에 버전이 지정 된 통신 프로토콜이 정의 되어 있습니다. 시작 핸드셰이크 중에 2 개 프로세스가 프로토콜 버전을 협상 합니다.

모든 NuGet 클라이언트 도구 시나리오를 처리 하기 위해 .NET Framework와 .NET Core 플러그 인이 모두 필요 합니다.
아래에서는 플러그 인의 클라이언트/프레임 워크 조합을 설명 합니다.

| 클라이언트 도구  | 프레임워크 |
| ------------ | --------- |
| Visual Studio | .NET Framework |
| dotnet.exe | .NET Core |
| Nuget.exe | .NET Framework |
| Msbuild.exe | .NET Framework |
| Mono의 Nuget.exe | .NET Framework |

## <a name="how-does-it-work"></a>작동 방식

개략적인 워크플로는 다음과 같이 설명할 수 있습니다.

1. NuGet은 사용 가능한 플러그 인을 검색 합니다.
1. 해당 하는 경우 NuGet은 우선 순위에 따라 플러그 인을 반복 하 여 하나씩 시작 합니다.
1. NuGet은 요청을 서비스 하는 데 사용할 수 있는 첫 번째 플러그 인을 사용 합니다.
1. 더 이상 필요 하지 않으면 플러그 인이 종료 됩니다.

## <a name="general-plugin-requirements"></a>일반 플러그 인 요구 사항

현재 프로토콜 버전은 *2.0.0*입니다.
이 버전에서 요구 사항은 다음과 같습니다.

- Windows 및 Mono에서 실행 되는 신뢰할 수 있는 올바른 Authenticode 서명 어셈블리가 있어야 합니다. Linux 및 Mac에서 아직 어셈블리를 실행 하기 위한 특별 한 신뢰 요구 사항은 없습니다. [관련 문제](https://github.com/NuGet/Home/issues/6702)
- NuGet 클라이언트 도구의 현재 보안 컨텍스트에서 상태 비저장 시작을 지원 합니다. 예를 들어 NuGet 클라이언트 도구는 나중에 설명 하는 플러그 인 프로토콜 외부에서 권한 상승이 나 추가 초기화를 수행 하지 않습니다.
- 명시적으로 지정 되지 않은 경우 비 대화형 이어야 합니다.
- 협상 된 플러그 인 프로토콜 버전을 준수 합니다.
- 적절 한 기간 내에 모든 요청에 응답 합니다.
- 진행 중인 작업에 대 한 취소 요청을 적용 합니다.

기술 사양은 다음 사양에 자세히 설명 되어 있습니다.

- [NuGet 패키지 다운로드 플러그 인](https://github.com/NuGet/Home/wiki/NuGet-Package-Download-Plugin)
- [NuGet 교차 cross-plat 인증 플러그 인](https://github.com/NuGet/Home/wiki/NuGet-cross-plat-authentication-plugin)

## <a name="client---plugin-interaction"></a>클라이언트-플러그 인 상호 작용

NuGet 클라이언트 도구 및 플러그 인은 표준 스트림 (stdin, stdout, stderr)을 통해 JSON과 통신 합니다. 모든 데이터는 u t f-8로 인코딩해야 합니다.
플러그 인은 "-Plugin" 인수를 사용 하 여 시작 됩니다. 사용자가이 인수 없이 플러그 인 실행 파일을 직접 시작 하는 경우 플러그 인은 프로토콜 핸드셰이크를 기다리는 대신 정보 메시지를 제공할 수 있습니다.
프로토콜 핸드셰이크 시간 제한은 5 초입니다. 플러그 인은 최대한 크기 만큼의 설치를 완료 해야 합니다.
NuGet 클라이언트 도구는 NuGet 소스에 대 한 서비스 인덱스를 전달 하 여 플러그 인의 지원 되는 작업을 쿼리 합니다. 플러그 인은 서비스 인덱스를 사용 하 여 지원 되는 서비스 유형이 있는지 확인할 수 있습니다.

NuGet 클라이언트 도구와 플러그 인 간의 통신은 양방향입니다. 각 요청에는 시간 제한이 5 초입니다. 작업이 더 오래 걸릴 것으로 예상 되는 경우 요청이 시간 초과 되지 않도록 각 프로세스에서 진행률 메시지를 전송 해야 합니다. 1 분 동안 활동이 없으면 플러그 인은 유휴 상태로 간주 되어 종료 됩니다.

## <a name="plugin-installation-and-discovery"></a>플러그 인 설치 및 검색

플러그 인은 규칙 기반 디렉터리 구조를 통해 검색 됩니다.
CI/CD 시나리오와 고급 사용자는 환경 변수를 사용 하 여 동작을 재정의할 수 있습니다. 환경 변수를 사용 하는 경우 절대 경로만 허용 됩니다. @No__t_0 및 `NUGET_NETCORE_PLUGIN_PATHS`는 5.3 이상 버전의 NuGet 도구 이상 에서만 사용할 수 있습니다.

- `NUGET_NETFX_PLUGIN_PATHS`-.NET Framework 기반 도구 (Nuget.exe/Msbuild.exe/Visual Studio)에서 사용할 플러그 인을 정의 합니다. @No__t_0 보다 우선적으로 적용 됩니다. (NuGet 버전 5.3 이상)
- `NUGET_NETCORE_PLUGIN_PATHS`-.NET Core 기반 도구 (dotnet)에서 사용할 플러그 인을 정의 합니다. @No__t_0 보다 우선적으로 적용 됩니다. (NuGet 버전 5.3 이상)
- `NUGET_PLUGIN_PATHS`-해당 NuGet 프로세스에 사용할 플러그 인을 정의 합니다. 우선 순위는 유지 됩니다. 이 환경 변수가 설정 되 면 규칙 기반 검색을 재정의 합니다. 프레임 워크 관련 변수 중 하나가 지정 된 경우 무시 됩니다.
-  @No__t_0의 NuGet 홈 위치인 사용자 위치입니다. 이 위치를 재정의할 수 없습니다. .NET Core 및 .NET Framework 플러그 인에는 다른 루트 디렉터리가 사용 됩니다.

| 프레임워크 | 루트 검색 위치  |
| ------- | ------------------------ |
| .NET Core |  `%UserProfile%/.nuget/plugins/netcore` |
| .NET Framework | `%UserProfile%/.nuget/plugins/netfx` |

각 플러그 인은 해당 폴더에 설치 해야 합니다.
플러그 인 진입점은 설치 된 폴더의 이름이 고, .NET Core의 경우 .dll 확장명, .NET Framework의 경우 .exe 확장명입니다.

```
.nuget
    plugins
        netfx
            myPlugin
                myPlugin.exe
                nuget.protocol.dll
                ...
        netcore
            myPlugin
                myPlugin.dll
                nuget.protocol.dll
                ...
```

> [!Note]
> 현재 플러그 인을 설치할 수 있는 사용자 스토리가 없습니다. 필수 파일을 미리 정해진 위치로 이동 하는 것 만큼 간단 합니다.

## <a name="supported-operations"></a>지원 되는 작업

새 플러그 인 프로토콜에서 두 가지 작업이 지원 됩니다.

| 작업 이름 | 최소 프로토콜 버전 | 최소 NuGet 클라이언트 버전 |
| -------------- | ----------------------- | --------------------- |
| 패키지 다운로드 | 1.0.0 | 4.3.0 |
| [인증](NuGet-Cross-Platform-Authentication-Plugin.md) | 2.0.0 | 4.8.0 |

## <a name="running-plugins-under-the-correct-runtime"></a>올바른 런타임에 플러그 인 실행

Dotnet의 NuGet 시나리오에서 플러그 인은 dotnet의 특정 런타임 아래에서 실행할 수 있어야 합니다.
호환 되는 dotnet/plugin 조합이 사용 되는지 확인 하기 위해 플러그 인 공급자와 소비자에 게 있습니다.
예를 들어 사용자 위치 플러그 인에서 잠재적 문제가 발생할 수 있습니다. 예를 들어, 2.0 런타임의 dotnet은 2.1 런타임에 대해 작성 된 플러그 인을 사용 하려고 합니다.

## <a name="capabilities-caching"></a>기능 캐싱

플러그 인의 보안 확인 및 인스턴스화는 비용이 많이 듭니다. 다운로드 작업은 인증 작업 보다 더 자주 수행 되지만 평균 NuGet 사용자에 게는 인증 플러그 인만 있을 수 있습니다.
환경을 개선 하기 위해 NuGet은 지정 된 요청에 대 한 작업 클레임을 캐시 합니다. 이 캐시는 플러그 인 키가 플러그 인 경로 이며이 기능 캐시의 만료는 30 일입니다. 

캐시는 `%LocalAppData%/NuGet/plugins-cache`에 있으며 `NUGET_PLUGINS_CACHE_PATH` 환경 변수를 사용 하 여 재정의 됩니다. 이 [캐시](../../consume-packages/managing-the-global-packages-and-cache-folders.md)를 지우려면 `plugins-cache` 옵션을 사용 하 여 지역 명령을 실행할 수 있습니다.
이제 `all` 지역 옵션이 플러그 인 캐시도 삭제 됩니다. 

## <a name="protocol-messages-index"></a>프로토콜 메시지 인덱스

프로토콜 버전 *1.0.0* 메시지:

1.  닫기
    * 요청 방향: NuGet-> 플러그 인
    * 요청에 페이로드가 포함 되지 않습니다.
    * 응답이 필요 하지 않습니다.  적절 한 응답은 플러그 인 프로세스를 즉시 종료 하는 것입니다.

2.  패키지의 파일 복사
    * 요청 방향: NuGet-> 플러그 인
    * 요청은 다음을 포함 합니다.
        * 패키지 ID 및 버전
        * 패키지 원본 리포지토리 위치
        * 대상 디렉터리 경로
        * 대상 디렉터리 경로에 복사할 패키지의 파일에 대 한 열거 가능
    * 응답에는 다음이 포함 됩니다.
        * 작업의 결과를 나타내는 응답 코드입니다.
        * 작업에 성공한 경우 대상 디렉터리에 복사 된 파일의 전체 경로를 열거 한 것입니다.

3.  패키지 파일 복사 (. nupkg)
    * 요청 방향: NuGet-> 플러그 인
    * 요청은 다음을 포함 합니다.
        * 패키지 ID 및 버전
        * 패키지 원본 리포지토리 위치
        * 대상 파일 경로
    * 응답에는 다음이 포함 됩니다.
        * 작업의 결과를 나타내는 응답 코드입니다.

4.  자격 증명 가져오기
    * 요청 방향: 플러그 인-> NuGet
    * 요청은 다음을 포함 합니다.
        * 패키지 원본 리포지토리 위치
        * 현재 자격 증명을 사용 하 여 패키지 원본 리포지토리에서 가져온 HTTP 상태 코드
    * 응답에는 다음이 포함 됩니다.
        * 작업의 결과를 나타내는 응답 코드입니다.
        * 사용자 이름 (사용 가능한 경우)
        * 암호 (사용 가능한 경우)

5.  패키지에서 파일 가져오기
    * 요청 방향: NuGet-> 플러그 인
    * 요청은 다음을 포함 합니다.
        * 패키지 ID 및 버전
        * 패키지 원본 리포지토리 위치
    * 응답에는 다음이 포함 됩니다.
        * 작업의 결과를 나타내는 응답 코드입니다.
        * 작업이 성공한 경우 패키지에서 파일 경로의 열거 가능

6.  작업 클레임 가져오기 
    * 요청 방향: NuGet-> 플러그 인
    * 요청은 다음을 포함 합니다.
        * 패키지 원본에 대 한 서비스 인덱스인 json
        * 패키지 원본 리포지토리 위치
    * 응답에는 다음이 포함 됩니다.
        * 작업의 결과를 나타내는 응답 코드입니다.
        * 작업이 성공한 경우 지원 되는 작업 (예: 패키지 다운로드)의 열거 가능입니다.  플러그 인에서 패키지 원본을 지원 하지 않는 경우 플러그 인은 지원 되는 빈 작업 집합을 반환 해야 합니다.

> [!Note]
> 이 메시지는 버전 *2.0.0*에서 업데이트 되었습니다. 클라이언트에서 이전 버전과의 호환성을 유지 합니다.

7.  패키지 해시 가져오기
    * 요청 방향: NuGet-> 플러그 인
    * 요청은 다음을 포함 합니다.
        * 패키지 ID 및 버전
        * 패키지 원본 리포지토리 위치
        * 해시 알고리즘
    * 응답에는 다음이 포함 됩니다.
        * 작업의 결과를 나타내는 응답 코드입니다.
        * 작업이 성공한 경우 요청 된 해시 알고리즘을 사용 하는 패키지 파일 해시

8.  패키지 버전 가져오기
    * 요청 방향: NuGet-> 플러그 인
    * 요청은 다음을 포함 합니다.
        * 패키지 ID
        * 패키지 원본 리포지토리 위치
    * 응답에는 다음이 포함 됩니다.
        * 작업의 결과를 나타내는 응답 코드입니다.
        * 작업이 성공한 경우 패키지 버전의 열거 가능

9.  서비스 인덱스 가져오기
    * 요청 방향: 플러그 인-> NuGet
    * 요청은 다음을 포함 합니다.
        * 패키지 원본 리포지토리 위치
    * 응답에는 다음이 포함 됩니다.
        * 작업의 결과를 나타내는 응답 코드입니다.
        * 작업이 성공한 경우의 서비스 인덱스

10.  핸드셰이크
     * 요청 방향: NuGet <-> 플러그 인
     * 요청은 다음을 포함 합니다.
         * 현재 플러그 인 프로토콜 버전
         * 지원 되는 최소 플러그 인 프로토콜 버전
     * 응답에는 다음이 포함 됩니다.
         * 작업의 결과를 나타내는 응답 코드입니다.
         * 작업에 성공한 경우 협상 된 프로토콜 버전입니다.  오류가 발생 하면 플러그 인이 종료 됩니다.

11.  Initialize
     * 요청 방향: NuGet-> 플러그 인
     * 요청은 다음을 포함 합니다.
         * NuGet 클라이언트 도구 버전
         * NuGet 클라이언트 도구 유효 언어입니다.  ForceEnglishOutput 설정을 사용 하는 경우이 설정을 고려 합니다.
         * 프로토콜 기본값을 대체 하는 기본 요청 시간 제한입니다.
     * 응답에는 다음이 포함 됩니다.
         * 작업의 결과를 나타내는 응답 코드입니다.  오류가 발생 하면 플러그 인이 종료 됩니다.

12.  로그
     * 요청 방향: 플러그 인-> NuGet
     * 요청은 다음을 포함 합니다.
         * 요청에 대 한 로그 수준입니다.
         * 로깅할 메시지
     * 응답에는 다음이 포함 됩니다.
         * 작업의 결과를 나타내는 응답 코드입니다.

13.  NuGet 프로세스 종료 모니터링
     * 요청 방향: NuGet-> 플러그 인
     * 요청은 다음을 포함 합니다.
         * NuGet 프로세스 ID
     * 응답에는 다음이 포함 됩니다.
         * 작업의 결과를 나타내는 응답 코드입니다.

14.  패키지 프리페치
     * 요청 방향: NuGet-> 플러그 인
     * 요청은 다음을 포함 합니다.
         * 패키지 ID 및 버전
         * 패키지 원본 리포지토리 위치
     * 응답에는 다음이 포함 됩니다.
         * 작업의 결과를 나타내는 응답 코드입니다.

15.  자격 증명 설정
     * 요청 방향: NuGet-> 플러그 인
     * 요청은 다음을 포함 합니다.
         * 패키지 원본 리포지토리 위치
         * 마지막으로 알려진 패키지 원본 사용자 이름 (사용 가능한 경우)
         * 마지막으로 알려진 패키지 원본 암호 (사용 가능한 경우)
         * 마지막으로 알려진 프록시 사용자 이름 (사용 가능한 경우)
         * 마지막으로 알려진 프록시 암호 (사용 가능한 경우)
     * 응답에는 다음이 포함 됩니다.
         * 작업의 결과를 나타내는 응답 코드입니다.

16.  로그 수준 설정
     * 요청 방향: NuGet-> 플러그 인
     * 요청은 다음을 포함 합니다.
         * 기본 로그 수준
     * 응답에는 다음이 포함 됩니다.
         * 작업의 결과를 나타내는 응답 코드입니다.

프로토콜 버전 *2.0.0* 메시지

17. 작업 클레임 가져오기

* 요청 방향: NuGet-> 플러그 인
    * 요청은 다음을 포함 합니다.
        * 패키지 원본에 대 한 서비스 인덱스인 json
        * 패키지 원본 리포지토리 위치
    * 응답에는 다음이 포함 됩니다.
        * 작업의 결과를 나타내는 응답 코드입니다.
        * 작업이 성공 하는 경우 지원 되는 작업의 열거 가능입니다.  플러그 인에서 패키지 원본을 지원 하지 않는 경우 플러그 인은 지원 되는 빈 작업 집합을 반환 해야 합니다.

    서비스 인덱스와 패키지 원본이 null 이면 플러그 인이 인증을 사용 하 여 대답할 수 있습니다.

18. 인증 자격 증명 가져오기

* 요청 방향: NuGet-> 플러그 인
* 요청은 다음을 포함 합니다.
    * URI
    * isRetry
    * 일부만
    * CanShowDialog
* 응답에는 다음이 포함 됩니다.
    * 사용자 이름
    * Password
    * 메시지
    * 인증 유형 목록
    * MessageResponseCode
